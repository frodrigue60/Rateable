document.addEventListener("DOMContentLoaded",v=>{const u=document.querySelector("#data"),m=document.querySelector("#form-filter");let s,r=1,l,d;const y=window.location.href;w(),m.addEventListener("change",function(a){let e=document.querySelector("#select-type").value,n=document.querySelector("#select-year").value,c=document.querySelector("#select-season").value,o=document.querySelector("#select-sort").value,t=document.querySelector("#select-char").value;p(e,n,c,o,t)}),window.addEventListener("scroll",function(){window.scrollY+window.innerHeight+300>=document.documentElement.scrollHeight&&(l==null||r<=l)&&(r++,h(r))});function i(a){fetch(a,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then(e=>{if(e.ok)return e.json();l=0}).then(e=>{if(e.html===""){l=0;return}else{let o=function(){c.forEach(t=>{t.textContent.length>25&&(t.textContent=t.textContent.substr(0,25)+"...")})};var n=o;l=e.lastPage,u.innerHTML+=e.html;let c=document.querySelectorAll(".post-titles");o()}}).catch(e=>console.error(e))}function h(a){let e=window.location.href,n=new URLSearchParams(window.location.search);n.has("filterBy")||n.has("type")||n.has("tag")||n.has("sort")||n.has("char")?s="&page=":s="?page=",d=e+s+a,i(d)}function w(){i(y)}function p(a,e,n,c,o){let t=new URL(window.location.href);r=1,g(),t.searchParams.set("type",a),t.searchParams.set("year",e),t.searchParams.set("season",n),t.searchParams.set("sort",c),t.searchParams.set("character",o);let f=t.toString();history.pushState(null,null,f),i(f)}function g(){u.innerHTML=""}});
