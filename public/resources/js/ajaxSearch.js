const q=document.querySelector("#exampleModal"),c=document.querySelector("#posts"),l=document.querySelector("#artists"),i=document.querySelector("#tags"),u=document.querySelector("#users"),p=document.querySelector("#searchInputModal"),S=document.querySelector('meta[name="csrf-token"]').content,k=document.querySelectorAll(".post-titles"),D=document.querySelector(".loader-container"),g=document.querySelector("body");document.querySelector("#modalBody");const b=document.querySelector(".res");let v;document.addEventListener("DOMContentLoaded",function(){D.style.display="none",g.removeAttribute("hidden"),f(),y(),q.addEventListener("shown.bs.modal",function(){p.focus(),p.addEventListener("keyup",()=>{m(),E(),clearTimeout(v),p.value.length>=1?v=setTimeout(s,250):(m(),f())});function s(){try{fetch("https://anirank-edcb15de9fd7.herokuapp.com/api/search?q="+p.value,{headers:{"X-Request-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRF-TOKEN":S},method:"GET"}).then(t=>t.json()).then(t=>{m(),t.posts.forEach(e=>{let d="https://anirank-edcb15de9fd7.herokuapp.com/anime/"+e.id+"/"+e.slug,n=document.createElement("div");n.classList.add("result");let a=document.createElement("a");a.href=d,a.textContent=e.title,n.appendChild(a),c.appendChild(n)}),t.artists.forEach(e=>{let d="https://anirank-edcb15de9fd7.herokuapp.com/artist/"+e.id+"/"+e.name_slug,n=document.createElement("div");n.classList.add("result");let a=document.createElement("a");a.href=d,a.textContent=e.name,n.appendChild(a),l.appendChild(n)}),t.tags.forEach(e=>{let d=e.name.split(" "),n=d[0],L="https://anirank-edcb15de9fd7.herokuapp.com/animes?type=&year="+d[1]+"&season="+n+"&sort=&char=",h=document.createElement("div");h.classList.add("result");let C=document.createElement("a");C.href=L,C.textContent=e.name,h.appendChild(C),i.appendChild(h)}),t.users.forEach(e=>{let d="https://anirank-edcb15de9fd7.herokuapp.com/user/"+e.id,n=document.createElement("div");n.classList.add("result");let a=document.createElement("a");a.href=d,a.textContent=e.name,n.appendChild(a),u.appendChild(n)}),b.classList.remove("hidden")})}catch{}}});function m(){c.innerHTML="",l.innerHTML="",i.innerHTML="",u.innerHTML=""}function f(){c.appendChild(r("posts")),l.appendChild(r("artists")),i.appendChild(r("tags")),u.appendChild(r("users"))}function y(){k.forEach(s=>{s.textContent.length>25&&(s.textContent=s.textContent.substr(0,25)+"...")})}function r(s){let t=document.createElement("div");t.className="result",t.id=s;let e=document.createElement("span");return e.textContent="Nothing",t.appendChild(e),t}function o(){const s=document.createElement("div");s.className="d-flex justify-content-center";const t=document.createElement("div");t.className="spinner-border",t.setAttribute("role","status");const e=document.createElement("span");return e.className="visually-hidden",e.textContent="Loading...",t.appendChild(e),s.appendChild(t),s}function E(){c.appendChild(o()),l.appendChild(o()),i.appendChild(o()),u.appendChild(o())}});
